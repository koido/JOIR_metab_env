# Google Colab での実行

何らかの理由で環境構築がうまくいかない場合などには、Google Colaboratory (Colab) を利用して解析ハンズオンに参加する方法を説明します。

## 事前準備: Colab へアクセス

1. ブラウザで [Google Colab](https://colab.research.google.com) を開きます。
2. Google アカウントでサインインします。アカウントが無い場合は無料で作成できます。
3. **File** → **New notebook** を選んで新しいノートブックを作成するか、既存のノートブックを開きます。

## 解析ハンズオンに使えそうな Colab ノートブック

解析環境構築までのノートブックを用意しました。

- [Colab ノートブック (miniconda使用)](https://colab.research.google.com/gist/koido/6ab17ce6caa338717528bb5d9f3f1c99/joir_env_demo.ipynb?hl=ja)
- [Colab ノートブック（miniforge使用）](https://colab.research.google.com/gist/koido/f57420a3c14832459aa0462c495de189/joir_env_demo_miniforge.ipynb?hl=ja)


## セルの実行方法と注意点

- セル左側の再生ボタンを押すと、そのセルのみを実行できます。
- **Runtime** → **Run all** で全セルを上から順に実行できます。
- セルを好きな順番で実行できる反面、前のセルで定義した変数がないとエラーになることがあります。
- 基本的には上から順番に実行するように作成しています。
    - 再現性に直結する重要なポイントです。
    - セルの左側に実行順番を示す番号が表示されます。

## Jupyter Notebook との相違点

- Colab はクラウド上で動作するため、ローカルに Python をインストールせずに利用できます。
- GPU/TPU を無料で使えますが、一定時間操作しないとランタイムが停止します。
- インターフェースやショートカットはほぼ同じですが、ファイルシステムは一時的なため、作業内容は適宜ダウンロードするか Google Drive（連携可能、説明は省略）へ保存しておくことを推奨します。

## よく使うショートカット

Colab ではキーボードショートカットを利用してセルの実行や保存を素早く行えます。

- `Shift+Enter` — セルを実行して次のセルに移動
- `Ctrl` (または `Cmd`) + `Enter` — セルを実行してカーソルをそのまま保持
- `Ctrl` (または `Cmd`) + `M` -> `h` — ショートカット一覧を表示
- `Ctrl` (または `Cmd`) + `M` -> `a` — 上に新しいセルを追加
- `Ctrl` (または `Cmd`) + `M` -> `b` — 下に新しいセルを追加
- `Ctrl` (または `Cmd`) + `M` -> `m` — セルを Markdown に変更
- `Ctrl` (または `Cmd`) + `M` -> `y` — セルをコードに変更

## Colab のランタイムについて

本セミナーでは GPU を使用しない CPU ランタイム を前提とします。

2025年5月時点でのColabの無料プランでは、CPU ランタイムは通常次のような構成です：

- vCPU: 2 基程度（変動あり）
- メモリ: 約 12 GB
- OS: Ubuntu Linux ベース

参考までに、GPU ランタイムを選択した場合は、一般的に以下のような環境が割り当てられます：

- vCPU: 2〜4 基（GPU によって変動）
- メモリ: 約 13 GB
- GPU: NVIDIA Tesla T4（VRAM 約 15 GB）または P100（VRAM 16 GB）

※ ランタイムの構成は利用状況や時間帯により変更されることがあります。

## Colab上での仮想環境について

Colab では、デフォルトでは `conda` を使った仮想環境の作成はできません。

そのため、今回ちょっと裏技のようなアプローチを行っており、やや煩雑です。

詳細は、共有している Colab ノートブックをご覧ください。